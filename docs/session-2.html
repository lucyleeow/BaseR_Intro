<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Session 2 | Introduction to Base R</title>
  <meta name="description" content="Introductory tutorial to base R, with a biological focus. In particular it will focus on analysing RNA-sequencing data with Bioconductor." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Session 2 | Introduction to Base R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introductory tutorial to base R, with a biological focus. In particular it will focus on analysing RNA-sequencing data with Bioconductor." />
  <meta name="github-repo" content="lucyleeow/BaseR_Intro" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Session 2 | Introduction to Base R" />
  
  <meta name="twitter:description" content="Introductory tutorial to base R, with a biological focus. In particular it will focus on analysing RNA-sequencing data with Bioconductor." />
  

<meta name="author" content="Lucy Liu" />


<meta name="date" content="2020-09-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="session-1.html"/>
<link rel="next" href="session-3.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Base R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#data-files"><i class="fa fa-check"></i><b>0.1</b> Data files</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="session-1.html"><a href="session-1.html"><i class="fa fa-check"></i><b>1</b> Session 1</a><ul>
<li class="chapter" data-level="1.1" data-path="session-1.html"><a href="session-1.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="session-1.html"><a href="session-1.html#r-scripts"><i class="fa fa-check"></i><b>1.2</b> R scripts</a></li>
<li class="chapter" data-level="1.3" data-path="session-1.html"><a href="session-1.html#help"><i class="fa fa-check"></i><b>1.3</b> Help</a></li>
<li class="chapter" data-level="1.4" data-path="session-1.html"><a href="session-1.html#working-directory"><i class="fa fa-check"></i><b>1.4</b> Working directory</a></li>
<li class="chapter" data-level="1.5" data-path="session-1.html"><a href="session-1.html#maths"><i class="fa fa-check"></i><b>1.5</b> Maths</a></li>
<li class="chapter" data-level="1.6" data-path="session-1.html"><a href="session-1.html#comps"><i class="fa fa-check"></i><b>1.6</b> Comparisons</a></li>
<li class="chapter" data-level="1.7" data-path="session-1.html"><a href="session-1.html#variables"><i class="fa fa-check"></i><b>1.7</b> Variables</a><ul>
<li class="chapter" data-level="1.7.1" data-path="session-1.html"><a href="session-1.html#errors-and-warnings"><i class="fa fa-check"></i><b>1.7.1</b> Errors and warnings</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="session-1.html"><a href="session-1.html#data-structures"><i class="fa fa-check"></i><b>1.8</b> Data structures</a><ul>
<li class="chapter" data-level="1.8.1" data-path="session-1.html"><a href="session-1.html#vector"><i class="fa fa-check"></i><b>1.8.1</b> Vector</a></li>
<li class="chapter" data-level="1.8.2" data-path="session-1.html"><a href="session-1.html#matrix"><i class="fa fa-check"></i><b>1.8.2</b> Matrix</a></li>
<li class="chapter" data-level="1.8.3" data-path="session-1.html"><a href="session-1.html#dataframe"><i class="fa fa-check"></i><b>1.8.3</b> Dataframe</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="session-1.html"><a href="session-1.html#reading-in-data"><i class="fa fa-check"></i><b>1.9</b> Reading in data</a><ul>
<li class="chapter" data-level="1.9.1" data-path="session-1.html"><a href="session-1.html#summary"><i class="fa fa-check"></i><b>1.9.1</b> Summary</a></li>
<li class="chapter" data-level="1.9.2" data-path="session-1.html"><a href="session-1.html#structure"><i class="fa fa-check"></i><b>1.9.2</b> Structure</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="session-1.html"><a href="session-1.html#data-types"><i class="fa fa-check"></i><b>1.10</b> Data types</a><ul>
<li class="chapter" data-level="1.10.1" data-path="session-1.html"><a href="session-1.html#factors"><i class="fa fa-check"></i><b>1.10.1</b> Factors</a></li>
<li class="chapter" data-level="1.10.2" data-path="session-1.html"><a href="session-1.html#type-coercion"><i class="fa fa-check"></i><b>1.10.2</b> Type coercion</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="session-1.html"><a href="session-1.html#vect"><i class="fa fa-check"></i><b>1.11</b> Vectorisation</a></li>
<li class="chapter" data-level="1.12" data-path="session-1.html"><a href="session-1.html#write"><i class="fa fa-check"></i><b>1.12</b> Writing out data</a></li>
<li class="chapter" data-level="1.13" data-path="session-1.html"><a href="session-1.html#homework"><i class="fa fa-check"></i><b>1.13</b> Homework</a></li>
<li class="chapter" data-level="1.14" data-path="session-1.html"><a href="session-1.html#answers"><i class="fa fa-check"></i><b>1.14</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="session-2.html"><a href="session-2.html"><i class="fa fa-check"></i><b>2</b> Session 2</a><ul>
<li class="chapter" data-level="2.1" data-path="session-2.html"><a href="session-2.html#functions"><i class="fa fa-check"></i><b>2.1</b> Functions</a></li>
<li class="chapter" data-level="2.2" data-path="session-2.html"><a href="session-2.html#miss"><i class="fa fa-check"></i><b>2.2</b> Missing values</a><ul>
<li class="chapter" data-level="2.2.1" data-path="session-2.html"><a href="session-2.html#missing-codes"><i class="fa fa-check"></i><b>2.2.1</b> Missing codes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="session-2.html"><a href="session-2.html#subsetting"><i class="fa fa-check"></i><b>2.3</b> Subsetting</a><ul>
<li class="chapter" data-level="2.3.1" data-path="session-2.html"><a href="session-2.html#subsetting-with-indicies"><i class="fa fa-check"></i><b>2.3.1</b> Subsetting with indicies</a></li>
<li class="chapter" data-level="2.3.2" data-path="session-2.html"><a href="session-2.html#subsetting-with-logicals"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting with logicals</a></li>
<li class="chapter" data-level="2.3.3" data-path="session-2.html"><a href="session-2.html#in"><i class="fa fa-check"></i><b>2.3.3</b> %in%</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="session-2.html"><a href="session-2.html#merge"><i class="fa fa-check"></i><b>2.4</b> Merge</a></li>
<li class="chapter" data-level="2.5" data-path="session-1.html"><a href="session-1.html#homework"><i class="fa fa-check"></i><b>2.5</b> Homework</a></li>
<li class="chapter" data-level="2.6" data-path="session-1.html"><a href="session-1.html#answers"><i class="fa fa-check"></i><b>2.6</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="session-3.html"><a href="session-3.html"><i class="fa fa-check"></i><b>3</b> Session 3</a><ul>
<li class="chapter" data-level="3.1" data-path="session-3.html"><a href="session-3.html#lists"><i class="fa fa-check"></i><b>3.1</b> Lists</a><ul>
<li class="chapter" data-level="3.1.1" data-path="session-3.html"><a href="session-3.html#named-list"><i class="fa fa-check"></i><b>3.1.1</b> Named list</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="session-3.html"><a href="session-3.html#classes"><i class="fa fa-check"></i><b>3.2</b> Classes</a></li>
<li class="chapter" data-level="3.3" data-path="session-3.html"><a href="session-3.html#packages"><i class="fa fa-check"></i><b>3.3</b> Packages</a></li>
<li class="chapter" data-level="3.4" data-path="session-3.html"><a href="session-3.html#dgelist"><i class="fa fa-check"></i><b>3.4</b> DGEList</a></li>
<li class="chapter" data-level="3.5" data-path="session-1.html"><a href="session-1.html#homework"><i class="fa fa-check"></i><b>3.5</b> Homework</a></li>
<li class="chapter" data-level="3.6" data-path="session-1.html"><a href="session-1.html#answers"><i class="fa fa-check"></i><b>3.6</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="session-4.html"><a href="session-4.html"><i class="fa fa-check"></i><b>4</b> Session 4</a><ul>
<li class="chapter" data-level="4.1" data-path="session-3.html"><a href="session-3.html#dgelist"><i class="fa fa-check"></i><b>4.1</b> DGEList</a></li>
<li class="chapter" data-level="4.2" data-path="session-4.html"><a href="session-4.html#filtering"><i class="fa fa-check"></i><b>4.2</b> Filtering</a></li>
<li class="chapter" data-level="4.3" data-path="session-4.html"><a href="session-4.html#normalisation"><i class="fa fa-check"></i><b>4.3</b> Normalisation</a></li>
<li class="chapter" data-level="4.4" data-path="session-4.html"><a href="session-4.html#mds"><i class="fa fa-check"></i><b>4.4</b> MDS</a><ul>
<li class="chapter" data-level="4.4.1" data-path="session-4.html"><a href="session-4.html#plotting"><i class="fa fa-check"></i><b>4.4.1</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="session-4.html"><a href="session-4.html#saving-plots"><i class="fa fa-check"></i><b>4.5</b> Saving plots</a></li>
<li class="chapter" data-level="4.6" data-path="session-4.html"><a href="session-4.html#linear-modelling"><i class="fa fa-check"></i><b>4.6</b> Linear modelling</a><ul>
<li class="chapter" data-level="4.6.1" data-path="session-4.html"><a href="session-4.html#design-matrix"><i class="fa fa-check"></i><b>4.6.1</b> Design matrix</a></li>
<li class="chapter" data-level="4.6.2" data-path="session-4.html"><a href="session-4.html#contrasts"><i class="fa fa-check"></i><b>4.6.2</b> Contrasts</a></li>
<li class="chapter" data-level="4.6.3" data-path="session-4.html"><a href="session-4.html#linear-model-fitting"><i class="fa fa-check"></i><b>4.6.3</b> Linear model fitting</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="session-4.html"><a href="session-4.html#statistical-testing"><i class="fa fa-check"></i><b>4.7</b> Statistical testing</a></li>
<li class="chapter" data-level="4.8" data-path="session-1.html"><a href="session-1.html#answers"><i class="fa fa-check"></i><b>4.8</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Base R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="session-2" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Session 2</h1>
<p>In this session we will learn about:</p>
<ul>
<li>how functions work</li>
<li>missing values</li>
<li>subsetting data structures</li>
<li>how to merge two dataframes</li>
</ul>
<div id="functions" class="section level2">
<h2><span class="header-section-number">2.1</span> Functions</h2>
<p>A function, as the name suggests performs a function. We have already used many functions. For example, the <code>read.delim()</code> function reads in data, the <code>sum()</code> function adds numbers up and the <code>merge()</code> function above merges two dataframes. In this section we will look at functions more formally.</p>
<p>When using a function, brackets (<code>( )</code>) always need to be included after the name of the function. Inputs (technically ‘arguments’) to the function are give within the brackets. You can find out what inputs an argument takes by looking at the help file.</p>
<p>For example, let’s take a look at the <code>rnorm()</code> function help file. This function generates a random number from a normal distribution.</p>
<div class="figure" style="text-align: center"><span id="fig:rnorm"></span>
<img src="Images/rnorm_help.png" alt="rnorm help file." width="600px" />
<p class="caption">
Figure 2.1: rnorm help file.
</p>
</div>
<p>We can see from the help file that <code>rnorm()</code> takes in 3 arguments:</p>
<pre><code>rnorm(n, mean = 0, sd = 1)</code></pre>
<p>The help file also tells us what each of these arguments does:</p>
<pre><code>n	- number of observations. If length(n) &gt; 1, the length is taken to be the number required.
mean - vector of means.
sd - vector of standard deviations.</code></pre>
<p><strong>Challenge 2.1</strong></p>
<ol style="list-style-type: decimal">
<li>Take a look at what the <code>rnorm()</code> function outputs in the code below. Try using various different inputs to the function then, try to answer the following questions:</li>
</ol>
<ul>
<li>What does <code>rnorm()</code> do when you only give it one number to the <code>mean</code> and <code>sd</code> arguments?</li>
<li>What happens when you give either argument a vector of numbers?</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="session-2.html#cb84-1"></a><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 11.230527  8.038588 10.596592  9.533643</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="session-2.html#cb86-1"></a><span class="kw">rnorm</span>(<span class="dv">3</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>), <span class="dt">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 101.0245660  -0.7811023 101.1758130</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Take a look at the following code:</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="session-2.html#cb88-1"></a><span class="kw">rnorm</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1]  0.05909466 -3.80624295 -5.53087788</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="session-2.html#cb90-1"></a><span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1]  4.4985328 -0.8168743 -2.7086207  3.9611001 -2.5910828 -2.8972996
##  [7]  1.8657075  1.3608831  2.4552253  4.8944242</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="session-2.html#cb92-1"></a><span class="kw">rnorm</span>(<span class="dv">3</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 10 10 10</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="session-2.html#cb94-1"></a><span class="kw">rnorm</span>(<span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]  2.7541078 -0.8548365  1.8226946</code></pre>
<p>How does the order of the arguments you input to the function affect the output? How does the order of the arguments you input affect the output, when you name each argument (along with the input)?</p>
<p>Note: as the function generates a random number, the numbers you will get from running the function will be different to the ones generated above.</p>
</div>
<div id="miss" class="section level2">
<h2><span class="header-section-number">2.2</span> Missing values</h2>
<p>Missing values are fairly common in data and in this section, we will look at how to deal with missing values in R. First, let’s read in some data. Recall we use the function <code>read.delim()</code> and tell R not to label words (character type data) as ‘Factors’ using <code>stringsAsFactors = FALSE</code>.</p>
<p>We are using the file “Ses2_genes.tsv” today. This would have been emailed to you before the session. (Alternatively you can download the data from <a href="https://github.com/lucyleeow/BaseR_Intro">GitHub</a>).</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="session-2.html#cb96-1"></a>genes &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/Ses2_genes.tsv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>You can see in the environment tab that this dataframe has 200 rows (observations) and 5 columns (variables). You can also click on the <code>genes</code> entry in the Environment tab (red arrow in Figure <a href="session-2.html#fig:RS4">2.2</a>) to display the data in a new window (left):</p>
<div class="figure"><span id="fig:RS4"></span>
<img src="Images/RS4.png" alt="Viewing data from the 'Environment' tab." width="700px" />
<p class="caption">
Figure 2.2: Viewing data from the ‘Environment’ tab.
</p>
</div>
<p>Scrolling down the window, you can see that there are several <em>NA</em> entries. <code>NA</code> denotes a missing value in R.</p>
<p><code>NA</code>‘s have some interesting behaviour - they are ’contagious’. For example, if we wanted to take the mean of a vector numbers, which includes a <code>NA</code>, the answer is <code>NA</code>. If we think about it, it makes sense that the mean of two numbers and a ‘missing’ number, that could be anything, is <code>NA</code>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="session-2.html#cb97-1"></a><span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="ot">NA</span>))</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Luckily many functions have a <code>na.rm</code> option, where you can tell it to remove <code>NA</code> values:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="session-2.html#cb99-1"></a><span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="ot">NA</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 2.5</code></pre>
<p>Later, we will learn how to remove the <code>NA</code> values from our dataframe.</p>
<div id="missing-codes" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Missing codes</h3>
<p>You may have also noticed that in the <code>SYMBOL</code> column, there is a value “missing” on row 3 and a value “Missing” on row 25. These have been used to denote missing values.</p>
<p>It is not uncommon for some people to denote missing values with some character (e.g. “x” or “none” or 999) when performing data entry. It is thus a good idea for us to learn how to deal with this.</p>
<p>We will learn how to do this in the next challenge. This challenge is designed for you to practice how to read help files and gain an understanding of an important computing concept.</p>
<p><strong>Challenge 2.2</strong></p>
<ol style="list-style-type: decimal">
<li>Using the “help” tab in RStudio, find the help file for the function <code>read.delim()</code>. You will notice that this help file describes several functions but all perform the function of reading data into R. It is not uncommon for functions that perform similar tasks to be grouped together in one help file.</li>
</ol>
<p>Read the “Arguments” section of the help file and find which argument could be used to tell R that “missing” and “Missing” should be interpreted as a missing value (i.e. a <code>NA</code>).</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Read in the file “Ses2_genes.tsv” again but use the argument identified above to tell R that “missing” should be a <code>NA</code>.</p></li>
<li><p>Amend your command above so that both “missing” and “Missing” are both interpreted as <code>NA</code>s.</p></li>
</ol>
</div>
</div>
<div id="subsetting" class="section level2">
<h2><span class="header-section-number">2.3</span> Subsetting</h2>
<p>Subsetting involves selecting a portion of a data structure and uses square brackets <code>[ ]</code>. There are two main ways to subset a data structure:</p>
<ul>
<li>Use indices - data structures are all ordered and ‘numbered’ in R. This means that you can refer to the 4th element in a vector or the element in the 1st row and 3rd column of a dataframe.</li>
<li>Use logicals - recall that a logical is <code>TRUE</code> or <code>FALSE</code>. You can use comparisons (e.g. equal to <code>==</code>, greater than <code>&gt;</code>) to determine if each element in your data structure meet your requirements and use this to subset your data.</li>
</ul>
<div id="subsetting-with-indicies" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Subsetting with indicies</h3>
<p>Let’s take a look at subsetting vectors first. We can use <code>$</code> to obtain just one column from the <code>genes</code> dataframe. The output will be a vector.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="session-2.html#cb101-1"></a>genes<span class="op">$</span>Count</span></code></pre></div>
<pre><code>##   [1]   979    15   932     0   214     2     2     0  1790    41  1033   700
##  [13]  2075   351    22     0     0   893     3   100 32100   269    34 20005
##  [25]  5751     0   275     9   849  7175   768   358   234  5065  2096  1994
##  [37]   757     0  2310     0     1     0  3091   810    30   816   817     1
##  [49]   580    33     0   941  1445   522     2  2346   572   431  5797     2
##  [61]    70  1236   966   235     2  3009   431   452  2602  3481    99 11857
##  [73]    35  1952     0   706  1317  1130    92     0   871   730  3892  3772
##  [85]    20     7     0   756     1   210   101    17    21   537  1240   930
##  [97]     1     1     0   221  1599     0    67     1     0   315     0     0
## [109]   739     0     0   976     1   715 18636   289  1396     0   101   285
## [121]  1665    47     2  4483     2   363   169   135     0     2     0    11
## [133]  4088  1082    92     0  3888    17     0     0     0     0     0     0
## [145]     0     0     0     0  2442    30  1610     0     0     0    16     1
## [157]     2     0    47     0  1118     0     1     0     2     3    22     0
## [169]     0     0     0     0     0     0   431     0     0    16     0     1
## [181]     0     4     0     0     1     0     0     0     0   301     0     0
## [193]     0     0     0     0     0     0     0    59</code></pre>
<p>We will assign this to a variable called <code>Counts</code>. <code>Counts</code> is now a variable that refers to a vector containing 200 integers.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="session-2.html#cb103-1"></a>Counts &lt;-<span class="st"> </span>genes<span class="op">$</span>Count</span></code></pre></div>
<p>This will give you the 3rd element of the vector <code>Counts</code>:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="session-2.html#cb104-1"></a>Counts[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] 932</code></pre>
<p>This will give you all the elements from the 3rd to the 10th:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="session-2.html#cb106-1"></a>Counts[<span class="dv">3</span><span class="op">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>## [1]  932    0  214    2    2    0 1790   41</code></pre>
<p>This will give you the 3rd, 5th and 10th elements:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="session-2.html#cb108-1"></a>Counts[<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">100</span>)]</span></code></pre></div>
<pre><code>## [1] 932 214 221</code></pre>
<p>Note that we have used <code>c()</code> within the square brackets. This is because R expects ONE ‘object’ within the square brackets. Thus, if you want to extract several indices, you must give it ONE vector containing the indices of the elements. A vector (e.g. <code>c(3,5,10)</code>) is considered one ‘object’ but the numbers <code>3,5,10</code> are considered three different ‘objects’.</p>
<p>Indeed, <code>3:10</code>, which we used earlier, is actually a vector of the numbers 3 to 10:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="session-2.html#cb110-1"></a><span class="dv">3</span><span class="op">:</span><span class="dv">10</span></span></code></pre></div>
<pre><code>## [1]  3  4  5  6  7  8  9 10</code></pre>
<p>Lastly, this gives you all the elements EXCEPT the elements 10 through to 200:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="session-2.html#cb112-1"></a>Counts[<span class="op">-</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">200</span>)]</span></code></pre></div>
<pre><code>## [1]  979   15  932    0  214    2    2    0 1790</code></pre>
<p>Subsetting a 2 dimensional data structure (e.g. a dataframe or matrix) is similar to subsetting a vector, except you now must specify which rows AND which columns you want. The syntax for the <code>genes</code> dataframe looks like this:</p>
<pre><code>genes[ (which rows you want) , (which columns you want) ]</code></pre>
<p>Within the square brackets, you must first tell R which rows you want LEFT of the comma, then which columns you want RIGHT of the comma.</p>
<p>The code below will give you the 3rd to 5th rows of the 2nd and 4th columns. Note that the output is a dataframe.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="session-2.html#cb115-1"></a>genes[<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]</span></code></pre></div>
<pre><code>##    SYMBOL GeneLength
## 3 missing       2515
## 4 Cacna1e      12697
## 5    Ccnf       3099</code></pre>
<p>We could have also done this using the names of the columns. Note that column names are enclosed in quotes signifying that they are of the ‘character’ data type.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="session-2.html#cb117-1"></a>genes[<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">c</span>(<span class="st">&quot;SYMBOL&quot;</span>,<span class="st">&quot;GeneLength&quot;</span>)]</span></code></pre></div>
<pre><code>##    SYMBOL GeneLength
## 3 missing       2515
## 4 Cacna1e      12697
## 5    Ccnf       3099</code></pre>
<p>If you leave the left side of comma empty, R will give you ALL the rows. If you leave the right side of the comma empty, R will give you ALL the columns.</p>
<p>This will give you the 2nd row and all the columns.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="session-2.html#cb119-1"></a>genes[<span class="dv">2</span>,]</span></code></pre></div>
<pre><code>##   EntrezID SYMBOL TXCHROM GeneLength Count
## 2    11634   Aire   chr10       1929    15</code></pre>
</div>
<div id="subsetting-with-logicals" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Subsetting with logicals</h3>
<p>If you recall from section <a href="session-1.html#comps">1.6</a>, you can make comparisons in R. The result of a comparison is either <code>TRUE</code> or <code>FALSE</code>:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="session-2.html#cb121-1"></a><span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Comparisons are also vectorised:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="session-2.html#cb123-1"></a>genes<span class="op">$</span>Count <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<pre><code>##   [1] FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE
##  [13] FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE
##  [25] FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [37] FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE
##  [49] FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE
##  [61]  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE
##  [73]  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE
##  [85]  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
##  [97]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
## [109] FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE
## [121] FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
## [133] FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [145]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
## [157]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [169]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
## [181]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
## [193]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>For each element in the vector <code>genes$Count</code>, R checks if it is less than 100, then returns either <code>TRUE</code> or <code>FALSE</code>. The output is a vector of logicals.</p>
<p>This can be used to subset in R. We will start with our <code>Counts</code> vector:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="session-2.html#cb125-1"></a>Counts[Counts <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>]</span></code></pre></div>
<pre><code>##   [1] 15  0  2  2  0 41 22  0  0  3 34  0  9  0  0  1  0 30  1 33  0  2  2 70  2
##  [26] 99 35  0 92  0 20  7  0  1 17 21  1  1  0  0 67  1  0  0  0  0  0  1  0 47
##  [51]  2  2  0  2  0 11 92  0 17  0  0  0  0  0  0  0  0  0  0 30  0  0  0 16  1
##  [76]  2  0 47  0  0  1  0  2  3 22  0  0  0  0  0  0  0  0  0 16  0  1  0  4  0
## [101]  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0 59</code></pre>
<p><code>Counts &lt; 100</code> will return a vector of 200 logicals, which indicate which elements are less than 100. Putting this inside square brackets will subset <code>Counts</code> such that only the elements that are less than 100 (the <code>TRUE</code>’s) remain.</p>
<p>This is done similarly in 2 dimensional data structures. The command below selects the rows where the <code>genes$Count</code> column equal to 0.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="session-2.html#cb127-1"></a>genes[genes<span class="op">$</span>Count <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,]</span></code></pre></div>
<p>The code below will output the ROWS where the <code>Count</code> column is equal to 0 and all the COLUMNS (because no input is given after the comma). As there are many rows with a <code>genes$Count</code> of 0, I’ll use the <code>head()</code> function to show just the first 6 rows of the output:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="session-2.html#cb128-1"></a><span class="kw">head</span>(genes[genes<span class="op">$</span>Count <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, ])</span></code></pre></div>
<pre><code>##    EntrezID  SYMBOL TXCHROM GeneLength Count
## 4     12290 Cacna1e    chr1      12697     0
## 8     12647    Chat   chr14       2810     0
## 16    14800   Gria2    chr3       7749     0
## 17    14843    Gsx2    chr5       1665     0
## 26    17695    Msmb   chr14        522     0
## 38    19888     Rp1    chr1       9747     0</code></pre>
<p>If you add <code>!</code> to the start of the <code>genes$Count == 0</code> condition statement, you will get all the rows where <code>genes$Count</code> is NOT equal to 0.</p>
<p>Another way to think about it is that <code>genes$Count == 0</code> gives you a logical vector of 200 <code>TRUE</code>’s and <code>FALSE</code>’s and <code>!</code> flips everything such that the <code>TRUE</code>’s become <code>FALSE</code>’s and vice versa.</p>
<p>We do this here and print the first 6 rows of the output:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="session-2.html#cb130-1"></a><span class="kw">head</span>(genes[<span class="op">!</span><span class="st"> </span>genes<span class="op">$</span>Count <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,])</span></code></pre></div>
<pre><code>##   EntrezID  SYMBOL TXCHROM GeneLength Count
## 1    11480  Acvr2a    chr2       5681   979
## 2    11634    Aire   chr10       1929    15
## 3    12156 missing    chr2       2515   932
## 5    12449    Ccnf   chr17       3099   214
## 6    12563    Cdh6   chr15       2632     2
## 7    12565    Cdh9   chr15       2903     2</code></pre>
<p>We can use the <code>$</code> shortcut to obtain just one column in a dataframe. We can’t do this with matrices - we have to use the <code>[ ]</code> notation instead.
For example, we can create a matrix from our <code>genes</code> dataframe. Recall that a matrix can only hold data of ONE data type - thus we will create a dataframe using just the <code>GeneLength</code> and <code>Count</code> columns of the <code>genes</code> dataframe. The first 6 rows are printed out:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="session-2.html#cb132-1"></a>gene_matrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(genes[,<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)])</span>
<span id="cb132-2"><a href="session-2.html#cb132-2"></a><span class="kw">head</span>(gene_matrix)</span></code></pre></div>
<pre><code>##      GeneLength Count
## [1,]       5681   979
## [2,]       1929    15
## [3,]       2515   932
## [4,]      12697     0
## [5,]       3099   214
## [6,]       2632     2</code></pre>
<p>If we wanted just the rows where <code>Count</code> was equal to 0, this is the notation we could use:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="session-2.html#cb134-1"></a><span class="kw">head</span>(</span>
<span id="cb134-2"><a href="session-2.html#cb134-2"></a>  gene_matrix[gene_matrix[,<span class="dv">2</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, ]</span>
<span id="cb134-3"><a href="session-2.html#cb134-3"></a>)</span></code></pre></div>
<pre><code>##      GeneLength Count
## [1,]      12697     0
## [2,]       2810     0
## [3,]       7749     0
## [4,]       1665     0
## [5,]        522     0
## [6,]       9747     0</code></pre>
<p>We used the <code>[ ]</code> to specify that we want to use the 2nd column of the matrix, which is the <code>Count</code> column. Like above, the <code>==</code> checks if each element in the <code>Count</code> column is 0. There is nothing entered to the right of the comma, indicating that we want all the columns.</p>
<p><strong>Challenge 2.3</strong></p>
<ol style="list-style-type: decimal">
<li>Subset the <code>genes</code> dataframe to obtain the rows where the <code>Count</code> is less than or equal to 10 and the columns <code>TXCHROM</code> and <code>Count</code>.</li>
<li>The function <code>is.na()</code> checks if each element in a vector is <code>NA</code>:</li>
</ol>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="session-2.html#cb136-1"></a><span class="kw">is.na</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>, <span class="ot">NA</span>))</span></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE</code></pre>
<p>Use this function to subset the <code>genes</code> dataframe so that all rows where <code>TXCHROM</code> column is <code>NA</code> is removed.</p>
<p>(Note you do not need to use the subsetted dataframe from question 1 for this question.)</p>
<ol start="3" style="list-style-type: decimal">
<li>Using the dataframe from above subset to get only the rows where the <code>TXCHROM</code> is ‘chr1’ and all columns.</li>
</ol>
<p><em>Hint</em>: you can refer to section <a href="session-1.html#comps">1.6</a> to check how to perform different types of comparisons in R.</p>
</div>
<div id="in" class="section level3">
<h3><span class="header-section-number">2.3.3</span> %in%</h3>
<p>In the last challenge, we used <code>==</code> to obtain the rows where <code>TXCHROM</code> is ‘chr1’. Another way to perform ‘matching’ tasks is with the <code>%in%</code> function.</p>
<p>The following command subsets the rows where <code>TXCHROM</code> is “chr1” or “chr2” and prints out the first 6 rows.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="session-2.html#cb138-1"></a><span class="kw">head</span>(</span>
<span id="cb138-2"><a href="session-2.html#cb138-2"></a>  genes[genes<span class="op">$</span>TXCHROM <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chr1&quot;</span>, <span class="st">&quot;chr2&quot;</span>),]</span>
<span id="cb138-3"><a href="session-2.html#cb138-3"></a>  )</span></code></pre></div>
<pre><code>##    EntrezID  SYMBOL TXCHROM GeneLength Count
## 1     11480  Acvr2a    chr2       5681   979
## 3     12156 missing    chr2       2515   932
## 4     12290 Cacna1e    chr1      12697     0
## 18    15064     Mr1    chr1       2509   893
## 19    15112    Hao1    chr2       2029     3
## 21    15939    Ier5    chr1       3270 32100</code></pre>
<p><strong>Challenge 2.4</strong></p>
<p>There is an important difference between <code>==</code> and <code>%in%</code>.</p>
<p>Let’s start by creating a vector of numbers:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="session-2.html#cb140-1"></a>vect1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">8</span>)</span></code></pre></div>
<p>We check which elements in our vector is equal to 5.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="session-2.html#cb141-1"></a>vect1 <span class="op">==</span><span class="st"> </span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE FALSE FALSE</code></pre>
<p>The output is what we would expect.</p>
<p>What if we wanted check which elements are equal to 5 OR 10? We might try something like this, where put the numbers we are checking for in a vector:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="session-2.html#cb143-1"></a>vect1</span></code></pre></div>
<pre><code>## [1] 10 10  5  5  8  8</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="session-2.html#cb145-1"></a>vect1 <span class="op">==</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<p>This isn’t the output we expected.</p>
<p>Let’s try the same task with <code>%in%</code>:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="session-2.html#cb147-1"></a>vect1 <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>This output IS what we want.</p>
<p>Take a look at the code above and see if you can understand what <code>==</code> does and what <code>%in%</code> does. This challenge is designed to make you think and be difficult.</p>
<p><em>Hint</em>: The story gets even more interesting if we try to use <code>==</code> to look for four numbers:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="session-2.html#cb149-1"></a>vect1 <span class="op">==</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning in vect1 == c(5, 10, 1, 3): longer object length is not a multiple of
## shorter object length</code></pre>
<pre><code>## [1] FALSE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<p>This warning message may seem a bit cryptic. The ‘longer’ object it is referring to is <code>vect1</code> which has 6 elements. The shorter object it is referring to is <code>c(5,10,1,3)</code>, which has 4 elements. Thus, it is saying that 6 is not a multiple of 4. The reason R wants the longer object to be a multiple of the shorter one, is key to understanding what is happening when we use <code>==</code>.</p>
</div>
</div>
<div id="merge" class="section level2">
<h2><span class="header-section-number">2.4</span> Merge</h2>
<p>Two dataframes can be combined with the <code>merge()</code> function.</p>
<p>For example, let’s say we have two dataframes (dataframe1 and dataframe2), each containing different information about 3 genes:</p>
<div class="figure"><span id="fig:merge1"></span>
<img src="Images/merge1.png" alt="The two dataframes to merge." width="750px" />
<p class="caption">
Figure 2.3: The two dataframes to merge.
</p>
</div>
<p>We can merge these dataframes together into one dataframe that contains all the information about genes. Notice that the order of the genes is not the same in the two dataframes. During the merge we want R to match each row according to the <code>Gene</code> column in each dataframe such that the correct information is added to the correct row. The result would have 4 columns, 3 rows and the correct information along each row.</p>
<div class="figure"><span id="fig:merge2"></span>
<img src="Images/merge2.png" alt="The two dataframes merged." width="750px" />
<p class="caption">
Figure 2.4: The two dataframes merged.
</p>
</div>
<p>Let’s practice merging on the files “Ses2_genes.tsv” and “Ses2_geneNames.tsv”. “Ses2_genes.tsv” contains gene EntrezIDs, gene symbol, gene chromosome, gene length and their count value. “Ses2_geneNames.tsv” contains gene names and their corresponding EntrezIDs.</p>
<p>First we will read in both files:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="session-2.html#cb152-1"></a>genes &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/Ses2_genes.tsv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb152-2"><a href="session-2.html#cb152-2"></a>gene_names &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/Ses2_geneNames.tsv&quot;</span>, </span>
<span id="cb152-3"><a href="session-2.html#cb152-3"></a>                         <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>What we want to do now, is to merge the two dataframes into one dataframe with 6 columns, containing the information from both dataframes. We also want to make sure that when R merges the dataframes, the correct information is added to the correct row. You will notice that both the <code>genes</code> and <code>gene_names</code> dataframes have a column giving the EntrezIDs. This column can be used as the “index” or “ID” column to make sure the correct information is added to each row. We can do this by telling <code>merge()</code> to match rows in the two dataframes using EntrezIDs during the merge.</p>
<p><code>merge()</code> has the following syntax:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="session-2.html#cb153-1"></a><span class="kw">merge</span>(</span>
<span id="cb153-2"><a href="session-2.html#cb153-2"></a>  <span class="dt">x =</span>    <span class="co"># name of the first dataframe to merge</span></span>
<span id="cb153-3"><a href="session-2.html#cb153-3"></a>  <span class="dt">y =</span>    <span class="co"># name of the second dataframe to merge</span></span>
<span id="cb153-4"><a href="session-2.html#cb153-4"></a>  <span class="dt">by.x =</span> <span class="co"># name of the column to match, in the first dataframe</span></span>
<span id="cb153-5"><a href="session-2.html#cb153-5"></a>  <span class="dt">by.y =</span> <span class="co"># name of the column to match in the second dataframe</span></span>
<span id="cb153-6"><a href="session-2.html#cb153-6"></a>)</span></code></pre></div>
<p>Thus, to merge our two dataframes, using the EntrezID column of each dataframe to match rows, we can use:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="session-2.html#cb154-1"></a>genes2 &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> genes, <span class="dt">y =</span> gene_names, </span>
<span id="cb154-2"><a href="session-2.html#cb154-2"></a>                <span class="dt">by.x =</span> <span class="st">&quot;EntrezID&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;ENTREZID&quot;</span>)</span>
<span id="cb154-3"><a href="session-2.html#cb154-3"></a></span>
<span id="cb154-4"><a href="session-2.html#cb154-4"></a><span class="kw">head</span>(genes2)</span></code></pre></div>
<pre><code>##   EntrezID  SYMBOL TXCHROM GeneLength Count
## 1    11480  Acvr2a    chr2       5681   979
## 2    11634    Aire   chr10       1929    15
## 3    12156 missing    chr2       2515   932
## 4    12290 Cacna1e    chr1      12697     0
## 5    12449    Ccnf   chr17       3099   214
## 6    12563    Cdh6   chr15       2632     2
##                                                                                GENENAME
## 1                                                                  activin receptor IIA
## 2 autoimmune regulator (autoimmune polyendocrinopathy candidiasis ectodermal dystrophy)
## 3                                                          bone morphogenetic protein 2
## 4                          calcium channel, voltage-dependent, R type, alpha 1E subunit
## 5                                                                              cyclin F
## 6                                                                            cadherin 6</code></pre>
<p>You may have noticed that there are 200 rows in the <code>genes</code> dataframe but 290 rows in the <code>gene_names</code> dataframe. This means that there are more genes in the <code>gene_names</code> dataframe than there are in the <code>genes</code> dataframe. This means that there are a few ways to merge the two dataframes. We can either keep all rows from both dataframes, keep only rows where there is a corresponding “index” value in both dataframes or keep only rows from one of the two dataframes.</p>
<p>We can specify which rows to keep using the following additional arguments in <code>merge()</code>:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="session-2.html#cb156-1"></a><span class="kw">merge</span>(</span>
<span id="cb156-2"><a href="session-2.html#cb156-2"></a>  <span class="dt">x =</span>     <span class="co"># name of the first dataframe to merge</span></span>
<span id="cb156-3"><a href="session-2.html#cb156-3"></a>  <span class="dt">y =</span>     <span class="co"># name of the second dataframe to merge</span></span>
<span id="cb156-4"><a href="session-2.html#cb156-4"></a>  <span class="dt">by.x =</span>  <span class="co"># name of the column to match, in the first dataframe</span></span>
<span id="cb156-5"><a href="session-2.html#cb156-5"></a>  <span class="dt">by.y =</span>  <span class="co"># name of the column to match in the second dataframe</span></span>
<span id="cb156-6"><a href="session-2.html#cb156-6"></a>  <span class="dt">all.x =</span> <span class="co"># logical. If TRUE, keep all rows from the first dataframe, </span></span>
<span id="cb156-7"><a href="session-2.html#cb156-7"></a>          <span class="co"># even if does not have a matching row in the second dataframe</span></span>
<span id="cb156-8"><a href="session-2.html#cb156-8"></a>  <span class="dt">all.y =</span> <span class="co"># logical. If TRUE, keep all rows from the second dataframe, </span></span>
<span id="cb156-9"><a href="session-2.html#cb156-9"></a>          <span class="co"># even if does not have a matching row in the second dataframe</span></span>
<span id="cb156-10"><a href="session-2.html#cb156-10"></a>)</span></code></pre></div>
<p>By default, <code>merge()</code> will only keep rows that have corresponding “index” values in both dataframes.</p>
<p><strong>Challenge 2.5</strong></p>
<p>Merge the two dataframes again, but this time keep all rows from both dataframes.</p>
</div>
<div id="homework" class="section level2">
<h2><span class="header-section-number">2.5</span> Homework</h2>
<ol style="list-style-type: decimal">
<li>Subset your <code>genes</code> dataframe to obtain the rows 5 to 10, 45 and 72 and all the columns EXCEPT column 4.</li>
<li>Subset your <code>genes</code> dataframe to obtain only rows where genes with the symbol is “Rab18”, “Ripk1” or “Xpr1” and all the columns.</li>
<li>Read in the tsv file “Ses2_PFAM.tsv” (remember to include <code>stringsAsFactors = FALSE</code>). This file gives the EntrezID next to the Pfam code for all our genes.
<ul>
<li>Remove all rows where the Pfam code is <code>NA</code></li>
<li>Merge this dataframe to <code>genes</code>, keeping all rows from both dataframes</li>
</ul></li>
</ol>
</div>
<div id="answers" class="section level2">
<h2><span class="header-section-number">2.6</span> Answers</h2>
<p><strong>Challenge 2.1</strong></p>
<ol style="list-style-type: decimal">
<li>If you provide <code>rnorm()</code> with a vector of inputs to either the <code>mean</code> or <code>sd</code> argument, it will use each element in that vector for successive random numbers generated and recycle the vector if it is shorter than the number of random numbers required.</li>
</ol>
<p>Thus, the following code:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="session-2.html#cb157-1"></a><span class="kw">rnorm</span>(<span class="dv">3</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>), <span class="dt">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>will generate 3 random numbers from the following normal distributions, in order:</p>
<pre><code>1. mean of 100 and sd of 1
2. mean of 0 and sd of 1
3. mean of 100 and sd of 1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>If you do not provide the name of the argument, <code>rnorm()</code> will use the first number provided as the argument to <code>n</code>, the second number provided as the input to <code>mean</code> and the third number provided as the input to <code>sd</code>.</li>
</ol>
<p>Thus, <code>rnorm(3,1,10)</code> generates 3 random numbers from a normal distribution with a mean of 1 and a standard deviation of 10 and <code>rnorm(3,10,1)</code> will generate 3 random numbers from a normal distribution with a mean of 10 and a standard deviation of 1.</p>
<p>If you give the argument name with the input, it does not matter what order you provide the inputs.</p>
<p><strong>Challenge 2.2</strong></p>
<ol style="list-style-type: decimal">
<li>The <code>na.strings</code> argument.</li>
<li></li>
</ol>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="session-2.html#cb159-1"></a>genes &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/Ses2_genes.tsv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,</span>
<span id="cb159-2"><a href="session-2.html#cb159-2"></a>                    <span class="dt">na.strings =</span> <span class="st">&quot;missing&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="session-2.html#cb160-1"></a>genes &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/Ses2_genes.tsv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,</span>
<span id="cb160-2"><a href="session-2.html#cb160-2"></a>                    <span class="dt">na.strings =</span> <span class="kw">c</span>(<span class="st">&quot;missing&quot;</span>, <span class="st">&quot;Missing&quot;</span>))</span></code></pre></div>
<p>The reason you need to give <code>c("missing", "Missing")</code> to the argument <code>na.strings</code> is quite complex. First, R expects only one “thing” (the technical term is “object” and we will discuss this more indepthly next session) for each argument. Notice that for the other arguments of <code>read.delim()</code>, only one “object” as been given. <code>"missing", "Missing"</code> is interpreted as two “objects” (two character values), whereas <code>c("missing", "Missing")</code> is one “object” (one vector that contains two values).</p>
<p>The other concept to note here is that <code>,</code> has a special meaning in functions. It is used to separate each argument. Thus, the comma in <code>"missing", "Missing"</code> causes R to interpret the <code>"Missing"</code> after the comma to be another argument to <code>read.delim()</code>. However, there is no argument called <code>"Missing"</code> and further, arguments should NEVER have quotes around them. The error you get <code>Error in !header : invalid argument type</code> is essentially saying this - arguments should not be characters.</p>
<p><strong>Challenge 2.3</strong></p>
<ol style="list-style-type: decimal">
<li>This code obtains rows where <code>Count</code> is less than or equal to 10 and prints the first 6 rows using <code>head()</code>:</li>
</ol>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="session-2.html#cb161-1"></a><span class="kw">head</span>(genes[genes<span class="op">$</span>Count <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>,])</span></code></pre></div>
<pre><code>##    EntrezID  SYMBOL TXCHROM GeneLength Count
## 4     12290 Cacna1e    chr1      12697     0
## 6     12563    Cdh6   chr15       2632     2
## 7     12565    Cdh9   chr15       2903     2
## 8     12647    Chat   chr14       2810     0
## 16    14800   Gria2    chr3       7749     0
## 17    14843    Gsx2    chr5       1665     0</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>This code removes all rows where the <code>TXCHROM</code> column has a NA value (keeping all columns) and prints the first 6 rows:</li>
</ol>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="session-2.html#cb163-1"></a><span class="kw">head</span>(genes[<span class="op">!</span><span class="st"> </span><span class="kw">is.na</span>(genes<span class="op">$</span>TXCHROM),])</span></code></pre></div>
<pre><code>##   EntrezID  SYMBOL TXCHROM GeneLength Count
## 1    11480  Acvr2a    chr2       5681   979
## 2    11634    Aire   chr10       1929    15
## 3    12156 missing    chr2       2515   932
## 4    12290 Cacna1e    chr1      12697     0
## 5    12449    Ccnf   chr17       3099   214
## 6    12563    Cdh6   chr15       2632     2</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>First we save the dataframe from the above as a variable called <code>genes_noNA</code>, then we subset to get only the rows where <code>TXCHROM</code> is ‘chr1’. Again we only print the first 6 rows of this output.</li>
</ol>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="session-2.html#cb165-1"></a>genes_noNA &lt;-<span class="st"> </span>genes[<span class="op">!</span><span class="st"> </span><span class="kw">is.na</span>(genes<span class="op">$</span>TXCHROM),]</span>
<span id="cb165-2"><a href="session-2.html#cb165-2"></a></span>
<span id="cb165-3"><a href="session-2.html#cb165-3"></a><span class="kw">head</span>(genes_noNA[genes_noNA<span class="op">$</span>TXCHROM <span class="op">==</span><span class="st"> &quot;chr1&quot;</span>,])</span></code></pre></div>
<pre><code>##    EntrezID  SYMBOL TXCHROM GeneLength Count
## 4     12290 Cacna1e    chr1      12697     0
## 18    15064     Mr1    chr1       2509   893
## 21    15939    Ier5    chr1       3270 32100
## 31    18777  Lypla1    chr1       2433   768
## 36    19775    Xpr1    chr1       7651  1994
## 38    19888     Rp1    chr1       9747     0</code></pre>
<p><strong>Challenge 2.4</strong></p>
<p>What <code>==</code> does is compare <code>vect1</code> with <code>c(5,10)</code> one by one. Since <code>c(5,10)</code> only has two elements, R repeats this shorter vector until it is the same length as the longer vector. This is called ‘recycling’.</p>
<p>Thus, the comparisons being made is the top row with each corresponding value in the bottom row, with the result being shown in the third row:</p>
<pre><code>10     10    5    5     8     8

5      10    5    10    5    10 

FALSE TRUE TRUE FALSE FALSE FALSE</code></pre>
<p>R gives you a warning whenever the length of the shorter vector is NOT a multiple of the longer vector.</p>
<p>When there were 4 elements in the shorter vector, it was not repeated a whole number of times - it was repeated 1.5 times. The comparisons being made between <code>vect1</code> and <code>c(5,10,1,3)</code> are:</p>
<pre><code>10     10    5    5     8     8

5      10    1    3     5    10 

FALSE TRUE FALSE FALSE FALSE FALSE</code></pre>
<p><code>%in%</code> simply performs matching and does not take order of the two vectors into consideration. It checks whether the values in <code>vect1</code> matches either number in <code>c(5,10)</code>. It thus gives us the result we expect.</p>
<p><strong>Challenge 2.5</strong></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="session-2.html#cb169-1"></a>genes2 &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> genes, <span class="dt">y =</span> gene_names, </span>
<span id="cb169-2"><a href="session-2.html#cb169-2"></a>                <span class="dt">by.x =</span> <span class="st">&quot;EntrezID&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;ENTREZID&quot;</span>,</span>
<span id="cb169-3"><a href="session-2.html#cb169-3"></a>                <span class="dt">by.x =</span> <span class="ot">TRUE</span>, <span class="dt">by.y =</span> <span class="ot">TRUE</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="session-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-session2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["IntroBaseR.pdf", "IntroBaseR.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
